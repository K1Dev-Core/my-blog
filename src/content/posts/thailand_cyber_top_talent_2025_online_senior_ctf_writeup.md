---
author: Kings (Hex / K1GOD)
description: Write-up ‡∏â‡∏ö‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà ‡∏õ‡∏µ‡πÅ‡∏£‡∏Å
draft: false
published: 2025-09-01
series: CTF
tags:
- ctf
title: Thailand Cyber Top Talent 2025 (Online-Senior) CTF Write-up
---

![thctt25](https://img2.pic.in.th/pic/thctt-2025-post.jpg)

‡∏õ‡∏µ‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏ß‡∏Å‡∏ú‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÑ‡∏ã‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÑ‡∏ó‡∏¢ 
- ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏ñ‡∏∑‡∏≠‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‡∏ó‡∏µ‡∏° Lincox
- write-up ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏£‡∏≠‡∏ö Online-Senior 2025\
(‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà ‡∏•‡∏≠‡∏á‡∏ú‡∏¥‡∏î‡∏•‡∏≠‡∏á‡∏ñ‡∏π‡∏Å ‡∏õ‡∏µ‡πÅ‡∏£‡∏Å ‚úåÔ∏è)

------------------------------------------------------------------------

## Network  ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 2: Whispers in the Wire (200)
![Whispers in the Wire (200)](https://img2.pic.in.th/pic/Screenshot-2025-08-30-140723.png)
‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÉ‡∏´‡πâ‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏™‡∏≠‡∏á‡∏ï‡∏±‡∏ß

-   `thctt2025_open_netsec3_whisper-in-the-wire.zip`
-   (‡πÅ‡∏ï‡∏Å‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ ‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡πà‡∏≤‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏Ñ‡∏∑‡∏≠ thctt2025_open_netsec3_whisper-in-the-wire.pcapng)


------------------------------------------------------------------------

### üîç Step 1 --- ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏ä‡πá‡∏Ñ

-   ‡πÄ‡∏õ‡∏¥‡∏î `.pcapng` ‡πÉ‡∏ô Wireshark\
-   ‡∏Å‡∏£‡∏≠‡∏á‡∏î‡∏π traffic ‡∏Å‡πá‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ flag ‡∏ï‡∏£‡∏á ‡πÜ\
-   ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤ data ‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô **compressed stream**
-   ‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÇ‡∏¢‡∏ô‡πÑ‡∏õ‡∏ñ‡∏≤‡∏° LLM ‡∏°‡∏±‡∏ô‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô zlib

------------------------------------------------------------------------

### üì¶ Step 2 --- ‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π zlib?

-   gRPC/HTTP2 ‡∏ä‡∏≠‡∏ö‡∏ö‡∏µ‡∏ö‡∏î‡πâ‡∏ß‡∏¢ zlib\
-   zlib ‡∏°‡∏µ header ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÄ‡∏ä‡πà‡∏ô `0x78 0x9C`\
-   ‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡∏´‡∏≤‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå

------------------------------------------------------------------------

### üõ†Ô∏è Step 3 --- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏°‡∏≤‡πÅ‡∏Å‡∏∞‡∏™‡∏∞‡∏´‡∏ô‡πà‡∏≠‡∏¢

‡πÉ‡∏ä‡πâ LLM ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô python ‡∏á‡πà‡∏≤‡∏¢‡πÜ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡∏∞‡∏≠‡∏≠‡∏Å‡∏°‡∏≤

``` python
import zlib

with open("thctt2025_open_netsec3_whisper-in-the-wire.pcapng", "rb") as f:
    data = f.read()

count = 0
for header in [b"\x78\x01", b"\x78\x5e", b"\x78\x9c", b"\x78\xda"]:
    start = 0
    while True:
        idx = data.find(header, start)
        if idx == -1:
            break
        try:
            out = zlib.decompress(data[idx:])
            text = out.decode(errors="ignore")
            print(f"\n=== Stream {count} at offset {idx} ===")
            print(text)
            count += 1
        except Exception:
            pass
        start = idx + 1

if count == 0:
    print("‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ stream ‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡πÑ‡∏î‡πâ")

```

------------------------------------------------------------------------

### üéØ Step 4 --- ‡πÄ‡∏à‡∏≠ flag

‡∏û‡∏≠‡πÅ‡∏ï‡∏Å‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏Å‡πá‡πÄ‡∏à‡∏≠‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤

    flag{fd3ca5a5acce56f112a725ce433c96e4}

------------------------------------------------------------------------

------------------------------------------------------------------------

## ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 2: \<‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏à‡∏ó‡∏¢‡πå\>

(‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô ‡∏£‡∏≠‡πÄ‡∏ï‡∏¥‡∏°)


------------------------------------------------------------------------

## Network ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 3: Custom Protocol v2 (300)
![Custom Protocol v2 (300)](https://img2.pic.in.th/pic/Screenshot-2025-08-30-140802-1.png)


> ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ: `thctt2025_open_netsec4_custom-protocol-v2.pcap` (+ ‡∏°‡∏µ‡∏™‡πÄ‡∏õ‡∏Ñ‡πÇ‡∏õ‡∏£‡πÇ‡∏ï‡∏Ñ‡∏≠‡∏• v2 ‡πÅ‡∏ô‡∏ö)\
> ‡∏£‡∏≠‡πÑ‡∏£ ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏™‡πÄ‡∏õ‡∏Ñ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡πá‡∏≠‡πã‡∏≠ ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å555 ‡πÅ‡∏ï‡πà‡∏à‡∏±‡∏ö‡∏à‡∏∏‡∏î‡πÑ‡∏î\
> ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡∏ñ‡∏≠‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÇ‡∏ï‡∏Ñ‡∏≠‡∏• **STH v2** ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡πà‡∏≤‡∏ô flag 

---

### üîé Step 1 ‚Äî ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏•‡∏¢‡∏¢‡∏¢‡∏¢‡∏¢  Wireshark

1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `.pcap` ‡πÉ‡∏ô **Wireshark**  
2. **filter**:
   ```
   udp && data[0:3]==53:54:48 && data[3]==02
   ```
   - `53:54:48` = ASCII `"STH"`
   - `data[3]==02` = ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô 0x02  
3. ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡πá‡∏ï‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: **HELLO (type=0x01)** ‚Üí **WELCOME (0x02)** ‚Üí **DATA (0x10)** ‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏ü‡∏£‡∏° ‚Üí **BYE (0x20)**


---

### üß© Step 2 ‚Äî ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡∏π‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô WELCOME (‡∏ï‡∏≤‡∏°‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏™‡πÄ‡∏õ‡∏Ñ)

1. ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏ü‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô **WELCOME** (`data[4]==02`)  
2. ‡πÄ‡∏Æ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå STH v2 ‡∏¢‡∏≤‡∏ß 23 ‡πÑ‡∏ö‡∏ï‡πå ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢ **payload** ‡∏Ç‡∏≠‡∏á WELCOME  
3. ‡∏•‡∏≤‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÑ‡∏ö‡∏ï‡πå‡πÉ‡∏ô **Packet Bytes**
4. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á **WELCOME payload**:
   ```
   server_nonce[8] | salt[8] | chunk_size[2] | total_chunks[2] |
   a[4] | c[4] | seed[4] | hint[2] | flags2[1] | reserved[1]
   ```
5. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á **HELLO payload**: `client_nonce[8] | name_len | name[...]`

**‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ :**
- `session_id` (‡∏à‡∏≤‡∏Å‡πÄ‡∏Æ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå WELCOME): `0xCB795043`
- `client_nonce`: `12 69 52 3B CC 32 C9 03`
- `server_nonce`: `02 41 EF A8 B2 36 89 9E`
- `salt`: `8A 0A 13 ED BD D1 2D D7`
- `chunk_size = 70`, `total_chunks = 5`
- LCG: `a = 261603731`, `c = 1`, `seed = 1976845399`
- `flags2 = 0x03` ‚áí ‡∏°‡∏µ **Base64 + Reverse**

---

### üóÉÔ∏è Step 3 ‚Äî ‡∏î‡∏π DATA ‡πÅ‡∏•‡πâ‡∏ß ‚Äú‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ä‡∏¥‡πâ‡∏ô‚Äù ‡∏ï‡∏≤‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏™‡πÄ‡∏õ‡∏Ñ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ 

- ‡πÄ‡∏ü‡∏£‡∏° **DATA** ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏ü‡∏£‡∏°‡∏°‡∏µ `seq` (‡∏î‡∏π‡πÉ‡∏ô‡πÄ‡∏Æ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå STH v2 ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏ö‡∏ï‡πå 11‚Äì14, big-endian) ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô index **‡∏´‡∏•‡∏±‡∏á** ‡∏ñ‡∏π‡∏Å‡∏™‡∏±‡∏ö  
- ‡πÉ‡∏ä‡πâ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏à‡∏≤‡∏Å WELCOME ‡∏ó‡∏≥‡∏•‡∏≥‡∏î‡∏±‡∏ö **LCG**:
  ```text
  n = total_chunks
  x0 = seed mod n
  x_{k+1} = (a*x_k + c) mod n
  order = [x0, x1, ..., x_{n-1}]
  ```
- ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ `order = [4, 0, 1, 2, 3]` -- 

---

### üß™ Step 4 ‚Äî ‡∏≠‡πà‡∏≤‡∏ô‡∏™‡πÄ‡∏õ‡∏Ñ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏•‡∏∞‡∏ó‡∏≥‡∏ï‡∏≤‡∏° (‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡πÇ‡∏¢‡∏ô‡πÉ‡∏ô LLM ‡∏ó‡∏≥‡πÄ‡∏•‡∏¢‡∏•‡∏∞‡∏Å‡∏±‡∏ô555)

1. **Base64-decode**   
2. **Reverse** (‡∏Å‡∏•‡∏±‡∏ö‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÑ‡∏ö‡∏ï‡πå) ‚Äî ‡∏ï‡∏≤‡∏° `flags2`  
3. **XOR** ‡∏Å‡∏±‡∏ö‡∏Ñ‡∏µ‡∏¢‡πå‡∏™‡∏ï‡∏£‡∏µ‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏ö‡∏•‡πá‡∏≠‡∏Å `SHA256`:
   ```text
   SHA256( session_id || client_nonce || server_nonce || salt || counter_be32 )
   ```
   ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡∏•‡∏∞‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢ `counter = 0,1,2,...` ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡πà‡∏≠‡∏à‡∏ô‡∏¢‡∏≤‡∏ß‡∏û‡∏≠  
4. ‡∏à‡∏∞‡πÑ‡∏î‡πâ zlib stream ‚Üí **zlib.decompress()** ‚Üí ‡πÑ‡∏î‡πâ plaintext

---

### üéØ ‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏ö‡∏ó‡∏µ‡πà LLM üòÇ

```
flag{48e64c539d58ac64f574b3c9abd9b6b1}
```

---


------------------------------------------------------------------------
